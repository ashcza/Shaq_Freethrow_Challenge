<html>
  <head>
    <script src="https://code.createjs.com/createjs-2015.11.26.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.10.0/matter.js"></script>
    <script>
      function init() {
        // module aliases
        var Engine = Matter.Engine,
            Render = Matter.Render,
            World = Matter.World,
            Bodies = Matter.Bodies;
        // create an engine
        var engine = Engine.create();
        engine.world.gravity.y = 1;

        // create a renderer
        var render = Render.create({
            element: document.body,
            engine: engine
        });



        // create two boxes and a ground
        var pole = Bodies.rectangle(650, 150, 20, 150, {
          isStatic: true
        });
        var rim1 = Bodies.rectangle(635, 200, 10, 5, { isStatic: true });
        var rim2 = Bodies.rectangle(580, 200, 5, 5, { isStatic: true });
        var ground = Bodies.rectangle(400, 480, 810, 60, { isStatic: true });

        // add all of the bodies to the world
        World.add(engine.world, [pole, rim1, rim2, ground]);


        // run the engine
        //Engine.run(engine);

        // run the renderer
        Render.run(render);


        var stage = new createjs.Stage("demoCanvas");
        var gravity = 1;
        var queue = [];



        class Ball {

          constructor(stage, force) {
            console.log("constructor");


            // adds the ball to the physics engine (x, y, radius)
            this.body = Bodies.circle(50, 200, 15)
            World.add(engine.world, [this.body]);
            this.addForce(force, -.026);
            this.body.restitution = .84;
            this.shape = new createjs.Shape();
            this.stage = stage;
            stage.addChild(this.shape);
          }

          addForce(dx, dy) {
            Matter.Body.applyForce(this.body, this.body.position, {x: dx, y: dy});
                }

          step() {
            //code for object moving off screen
            // if (this.x > this.stage.canvas.width) { this.x = 0; }
            // if (this.y > this.stage.canvas.height) { this.y = 0; }
          };

          draw() {
            this.shape.graphics.beginFill("DeepSkyBlue").drawCircle(0, 0, 15);
            this.shape.x = this.body.position.x;
            this.shape.y = this.body.position.y;
          };
        }


        queue.push(new Ball(stage, .0285));
        // stage.update();

        //Update stage will render next frame
        createjs.Ticker.addEventListener("tick", handleTick);

        function handleTick() {

          for(var i = 0; i < queue.length; i+=1) {
            // queue[i].step();
          }

          for(var i = 0; i < queue.length; i+=1) {
            queue[i].draw();
          }
          //step forward the physics engine
          Matter.Engine.update(engine);

          //Checks to see if ball exists
          if (engine.world.bodies[4]) {
          //Checks to see if basket was made
            if (Matter.Bounds.contains(engine.world.bodies[4].bounds, {x: 600, y: 220})) {
              console.log("WOoOOOO");
              // Matter.World.remove(engine.world, engine.world.bodies[4])
            }
          }
          Matter.Events.on(engine, 'collisionActive', function(e) {
            var i, pair,
                length = e.pairs.length;
            for(i = 0; i < length; i++) {
              pair = event.pairs[i];
              if(!(pair.bodyA.label === 'Player' || pair.bodyB.label === 'Player')) {
                continue;
              }
              //Here body with label 'Player' is in the pair, do some stuff with it
            }
          });

          //update canvas according to new physics engine calculations
          stage.update();
        }
      }


    </script>
  </head>
  <body onload="init();">
    <canvas id="demoCanvas" width="640" height="480"></canvas>

  </body>
</html>
